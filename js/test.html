<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨ºæ–­ãƒ†ã‚¹ãƒˆ - PhotoSession Connect</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .diagnostic-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .test-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .status {
            padding: 8px 15px;
            border-radius: 5px;
            margin: 5px 0;
            font-size: 0.95rem;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .image-test {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15aside;
            margin-top: 15px;
        }
        
        .image-box {
            aspect-ratio: 16/9;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #dee2e6;
            background: #f8f9fa;
            position: relative;
        }
        
        .image-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px;
            font-size: 0.8rem;
            text-align: center;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 20px;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        #results {
            margin-top: 20px;
        }
        
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #e83e8c;
        }
    </style>
</head>
<body>
    <div class="diagnostic-container">
        <h1>ğŸ” è¨ºæ–­ãƒ†ã‚¹ãƒˆ - PhotoSession Connect</h1>
        
        <!-- JavaScriptå‹•ä½œç¢ºèª -->
        <div class="test-section">
            <div class="test-title">1. JavaScriptå‹•ä½œç¢ºèª</div>
            <div id="js-test" class="status warning">JavaScriptç¢ºèªä¸­...</div>
        </div>
        
        <!-- ç¾åœ¨æ™‚åˆ» -->
        <div class="test-section">
            <div class="test-title">2. ãƒšãƒ¼ã‚¸æ›´æ–°æ™‚åˆ»</div>
            <div id="time-test" class="status info">èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>
        
        <!-- ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ± -->
        <div class="test-section">
            <div class="test-title">3. ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±</div>
            <div id="version-test" class="status info">ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2024.11.26.001</div>
            <div class="status info">ã‚‚ã—ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„å ´åˆã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ®‹ã£ã¦ã„ã¾ã™</div>
        </div>
        
        <!-- DOMè¦ç´ ç¢ºèª -->
        <div class="test-section">
            <div class="test-title">4. DOMè¦ç´ ã®å­˜åœ¨ç¢ºèª</div>
            <div id="dom-test">
                <div class="status info">ç¢ºèªä¸­...</div>
            </div>
        </div>
        
        <!-- ç”»åƒèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <div class="test-title">5. ç”»åƒèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ</div>
            <div class="image-test">
                <!-- ãƒ­ãƒ¼ã‚«ãƒ«ç”»åƒ -->
                <div class="image-box">
                    <img src="images/events/event001.jpg" 
                         alt="ãƒ­ãƒ¼ã‚«ãƒ«ç”»åƒ"
                         onerror="this.style.display='none'; this.parentElement.style.background='#ffcccc';"
                         onload="this.parentElement.style.background='#ccffcc';">
                    <div class="image-label">ãƒ­ãƒ¼ã‚«ãƒ«: event001.jpg</div>
                </div>
                
                <!-- ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç”»åƒ -->
                <div class="image-box">
                    <img src="https://via.placeholder.com/400x225/667eea/ffffff?text=Online+Test" 
                         alt="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç”»åƒ"
                         onerror="this.style.display='none'; this.parentElement.style.background='#ffcccc';"
                         onload="this.parentElement.style.background='#ccffcc';">
                    <div class="image-label">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³: Placeholder</div>
                </div>
                
                <!-- Data URIç”»åƒ -->
                <div class="image-box">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 225'%3E%3Crect fill='%23764ba2' width='400' height='225'/%3E%3Ctext x='200' y='112' text-anchor='middle' fill='white' font-size='20'%3EData URI Test%3C/text%3E%3C/svg%3E" 
                         alt="Data URIç”»åƒ">
                    <div class="image-label">Data URI: SVG</div>
                </div>
            </div>
            <div id="image-results" style="margin-top: 15px;"></div>
        </div>
        
        <!-- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ç¢ºèª -->
        <div class="test-section">
            <div class="test-title">6. ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</div>
            <div id="path-test" class="status info"></div>
        </div>
        
        <!-- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ç¢ºèª -->
        <div class="test-section">
            <div class="test-title">7. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°</div>
            <div class="status warning">F12ã‚­ãƒ¼ã§ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«ã‚’é–‹ãã€Consoleã‚¿ãƒ–ã‚’ç¢ºèªã—ã¦ãã ã•ã„</div>
        </div>
        
        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
        <button onclick="runFullDiagnostic()">ğŸ”„ å®Œå…¨è¨ºæ–­ã‚’å®Ÿè¡Œ</button>
        <button onclick="clearCacheAndReload()">ğŸ—‘ï¸ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã—ã¦å†èª­è¾¼</button>
        
        <div id="results"></div>
    </div>
    
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
        window.addEventListener('DOMContentLoaded', function() {
            console.log('=== è¨ºæ–­é–‹å§‹ ===');
            console.log('æ™‚åˆ»:', new Date().toLocaleString());
            
            // 1. JavaScriptå‹•ä½œç¢ºèª
            document.getElementById('js-test').className = 'status success';
            document.getElementById('js-test').textContent = 'âœ… JavaScriptæ­£å¸¸å‹•ä½œä¸­';
            
            // 2. ç¾åœ¨æ™‚åˆ»è¡¨ç¤º
            document.getElementById('time-test').textContent = 
                'æœ€çµ‚æ›´æ–°: ' + new Date().toLocaleString('ja-JP');
            
            // 3. ãƒ‘ã‚¹æƒ…å ±
            document.getElementById('path-test').innerHTML = 
                `ç¾åœ¨ã®URL: <code>${window.location.href}</code><br>` +
                `ãƒ—ãƒ­ãƒˆã‚³ãƒ«: <code>${window.location.protocol}</code>`;
            
            // 4. DOMè¦ç´ ç¢ºèª
            checkDOMElements();
            
            // 5. ç”»åƒçŠ¶æ…‹ç¢ºèª
            setTimeout(checkImages, 1000);
            
            // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è©³ç´°æƒ…å ±ã‚’å‡ºåŠ›
            console.log('ãƒ–ãƒ©ã‚¦ã‚¶:', navigator.userAgent);
            console.log('ç”»é¢ã‚µã‚¤ã‚º:', window.innerWidth + 'x' + window.innerHeight);
            console.log('=== è¨ºæ–­çµ‚äº† ===');
        });
        
        function checkDOMElements() {
            const tests = [
                { selector: '.event-card', name: 'ã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰' },
                { selector: '.event-card-image', name: 'ç”»åƒã‚³ãƒ³ãƒ†ãƒŠ' },
                { selector: '[data-event-id]', name: 'data-event-idå±æ€§' },
                { selector: 'img', name: 'ç”»åƒè¦ç´ ' }
            ];
            
            let html = '';
            tests.forEach(test => {
                const elements = document.querySelectorAll(test.selector);
                const status = elements.length > 0 ? 'success' : 'error';
                const icon = elements.length > 0 ? 'âœ…' : 'âŒ';
                html += `<div class="status ${status}">${icon} ${test.name}: ${elements.length}å€‹</div>`;
            });
            
            document.getElementById('dom-test').innerHTML = html;
        }
        
        function checkImages() {
            const images = document.querySelectorAll('.image-box img');
            let results = '';
            
            images.forEach((img, index) => {
                const loaded = img.complete && img.naturalHeight !== 0;
                const status = loaded ? 'success' : 'error';
                const icon = loaded ? 'âœ…' : 'âŒ';
                const label = img.parentElement.querySelector('.image-label').textContent;
                results += `<div class="status ${status}">${icon} ${label}</div>`;
            });
            
            document.getElementById('image-results').innerHTML = results;
        }
        
        function runFullDiagnostic() {
            console.clear();
            console.log('ğŸ”„ å®Œå…¨è¨ºæ–­å®Ÿè¡Œä¸­...');
            
            const results = document.getElementById('results');
            results.innerHTML = '<div class="status info">è¨ºæ–­å®Ÿè¡Œä¸­...</div>';
            
            setTimeout(() => {
                checkDOMElements();
                checkImages();
                
                const diagnosticData = {
                    timestamp: new Date().toISOString(),
                    url: window.location.href,
                    userAgent: navigator.userAgent,
                    screenSize: `${window.innerWidth}x${window.innerHeight}`,
                    images: document.querySelectorAll('img').length,
                    localStorage: typeof(Storage) !== "undefined",
                    cookies: navigator.cookieEnabled
                };
                
                console.table(diagnosticData);
                results.innerHTML = '<div class="status success">âœ… è¨ºæ–­å®Œäº†ï¼ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è©³ç´°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</div>';
            }, 1000);
        }
        
        function clearCacheAndReload() {
            if (confirm('ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ç”¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ 
                const timestamp = new Date().getTime();
                const separator = window.location.href.includes('?') ? '&' : '?';
                window.location.href = window.location.href.split('?')[0] + separator + 'v=' + timestamp;
            }
        }
    </script>
</body>
</html>