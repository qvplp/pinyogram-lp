<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š | Pinyogram - ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»äºˆç´„ã‚·ã‚¹ãƒ†ãƒ </title>
    
    <!-- Google Fonts - M PLUS Rounded 1c -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@100;300;400;500;700;800;900&display=swap" rel="stylesheet">
    
    <!-- SEOæœ€é©åŒ–ãƒ¡ã‚¿ã‚¿ã‚° -->
    <meta name="description" content="ã´ã«ã‚‡ãã‚‰ã‚€ï¼ˆPinyogramï¼‰æ’®å½±ä¼šã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã€‚å€‹äººæ’®å½±ä¼šãƒ»å›£ä½“æ’®å½±ä¼šã®æœ€æ–°æƒ…å ±ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„ãŒå¯èƒ½ã€‚å†™çœŸæ„›å¥½å®¶ã®ãŸã‚ã®æ’®å½±ä¼šãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚">
    <meta name="keywords" content="ã´ã«ã‚‡ãã‚‰ã‚€, pinyogram, æ’®å½±ä¼š, å†™çœŸæ’®å½±ä¼š, å€‹äººæ’®å½±ä¼š, å›£ä½“æ’®å½±ä¼š, ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«, æ’®å½±ä¼šäºˆç´„, å†™çœŸã‚¤ãƒ™ãƒ³ãƒˆ, ã‚«ãƒ¡ãƒ©ãƒãƒ³, ãƒ¢ãƒ‡ãƒ«æ’®å½±, æ’®å½±ä¼šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼, ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š">
    <meta name="author" content="Pinyogram">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D3J45W8YXL"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-D3J45W8YXL');
    </script>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pinyogram.com/event/">
    <meta property="og:title" content="ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š | Pinyogram - ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ">
    <meta property="og:description" content="ã´ã«ã‚‡ãã‚‰ã‚€ï¼ˆPinyogramï¼‰æ’®å½±ä¼šã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã€‚å€‹äººæ’®å½±ä¼šãƒ»å›£ä½“æ’®å½±ä¼šã®æœ€æ–°æƒ…å ±ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„ãŒå¯èƒ½ã€‚">
    <meta property="og:image" content="https://images.pinyogram.com/events/2025-11-18%20%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E6%92%AE%E5%BD%B1%E4%BC%9A/main/1118.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«">
    <meta property="og:site_name" content="ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š">
    <meta property="og:locale" content="ja_JP">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://pinyogram.com/event/">
    <meta name="twitter:title" content="ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š | Pinyogram - ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ">
    <meta name="twitter:description" content="ã´ã«ã‚‡ãã‚‰ã‚€ï¼ˆPinyogramï¼‰æ’®å½±ä¼šã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã€‚å€‹äººæ’®å½±ä¼šãƒ»å›£ä½“æ’®å½±ä¼šã®æœ€æ–°æƒ…å ±ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆç´„ãŒå¯èƒ½ã€‚">
    <meta name="twitter:image" content="https://images.pinyogram.com/events/2025-11-18%20%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E6%92%AE%E5%BD%B1%E4%BC%9A/main/1118.png">
    <meta name="twitter:image:alt" content="ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«">
    
    <!-- æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆJSON-LDï¼‰ -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Event",
      "name": "ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ã‚¤ãƒ™ãƒ³ãƒˆ",
      "description": "å†™çœŸæ’®å½±ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã€‚å€‹äººæ’®å½±ä¼šãƒ»å›£ä½“æ’®å½±ä¼šã®æƒ…å ±æä¾›ã€‚",
      "url": "https://pinyogram.com/event/",
      "image": "https://images.pinyogram.com/events/2025-11-18%20%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E6%92%AE%E5%BD%B1%E4%BC%9A/main/1118.png",
      "organizer": {
        "@type": "Organization",
        "name": "ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š",
        "alternateName": "Pinyogram",
        "url": "https://pinyogram.com"
      },
      "eventStatus": "https://schema.org/EventScheduled",
      "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
      "location": {
        "@type": "Place",
        "name": "æ’®å½±ä¼šä¼šå ´",
        "address": {
          "@type": "PostalAddress",
          "addressCountry": "JP"
        }
      },
      "offers": {
        "@type": "Offer",
        "availability": "https://schema.org/InStock",
        "price": "0",
        "priceCurrency": "JPY"
      }
    }
    </script>
    
    <link rel="canonical" href="https://pinyogram.com/event/">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/shared/style.css?v=11.1.0">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã®ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ -->
    <link rel="preload" as="image" href="https://images.pinyogram.com/events/2025%3A10%3A21%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E6%92%AE%E5%BD%B1%E4%BC%9Awith%E7%A6%8F%E5%B3%B6%E8%A3%95%E4%BA%8C/main/Frame%2056.png">
    
    <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23007AFF'/><circle cx='50' cy='50' r='30' fill='white'/></svg>">
</head>

<body>
    <!-- å…±æœ‰ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div id="site-header"></div>
    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ãƒ ãƒ¼ãƒ“ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section class="hero-video-section">
        <div class="hero-video-wrapper">
            <video 
                id="hero-video"
                class="hero-video" 
                autoplay
                muted
                loop
                playsinline
                controls 
                preload="metadata"
                poster="../assets/images/common/placeholder.jpg"
                aria-label="ã´ã«ã‚‡ãã‚‰ã‚€ã‚¤ãƒ™ãƒ³ãƒˆç´¹ä»‹å‹•ç”»">
                <!-- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆçµ¶å¯¾ãƒ‘ã‚¹ï¼‰ -->
                <source src="/assets/videos/event-hiro.webm" type="video/webm">
                ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å‹•ç”»ã‚¿ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚
            </video>
            
            <!-- èª­ã¿ã‚„ã™ã•ç”¨ã®è–„ã„é»’ãƒ¬ã‚¤ãƒ¤ãƒ¼ -->
            <div class="hero-video-overlay"></div>
            
            <!-- ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ï¼ˆå·¦å¯„ã›ã€ç¸¦ä¸­å¤®ã‚„ã‚„ä¸Šï¼‰ -->
            <div class="hero-text-overlay">
                <h1 class="hero-title">
                    PHOTO<br />SESSION
                </h1>
                <p class="hero-description">
                    ã€Œæ’®ã‚‹ã€ã€Œä½œã‚‹ã€ã€Œå¿œæ´ã™ã‚‹ã€ã‚’ã¤ãªã’ã€å¥³ã®å­ã‚‚ãƒ•ã‚¡ãƒ³ã‚‚ã¿ã‚“ãªãŒå¬‰ã—ããªã‚‹æ–°ã—ã„å½¢ã®æ’®å½±ä¼šã§ã™ã€‚
                </p>
            </div>
            
            <!-- ä¸‹å‘ãã®ç™½ã„ä¸‰è§’å½¢ãƒœã‚¿ãƒ³ï¼ˆ#events ã¸ï¼‰ -->
            <a
                href="#events"
                aria-label="ä¸‹ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«"
                class="hero-scroll-button"
            >
                <span class="sr-only">ä¸‹ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«</span>
                <span class="scroll-arrow"></span>
            </a>
        </div>
    </section>
    
    <script>
        // å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚’ç¢ºå®Ÿã«ã™ã‚‹
        (function() {
            function initVideo() {
                const video = document.getElementById('hero-video');
                if (!video) {
                    console.warn('âš ï¸ å‹•ç”»è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    return;
                }
                
                console.log('ğŸ¬ å‹•ç”»è¦ç´ ã‚’æ¤œå‡ºã—ã¾ã—ãŸ');
                
                // sourceè¦ç´ ã®ãƒ‘ã‚¹ã‚’ç¢ºèªãƒ»ä¿®æ­£
                const sources = video.querySelectorAll('source');
                const baseUrl = window.location.origin;
                const currentPath = window.location.pathname;
                const isEventPage = currentPath.includes('/event/');
                
                // ãƒ‘ã‚¹ã®å€™è£œã‚’å®šç¾©
                const pathCandidates = [
                    '../assets/videos/event-hiro.webm',  // ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆevent/ã‹ã‚‰ï¼‰
                    '/assets/videos/event-hiro.webm',   // ãƒ«ãƒ¼ãƒˆã‹ã‚‰ã®çµ¶å¯¾ãƒ‘ã‚¹
                    'assets/videos/event-hiro.webm'     // ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹
                ];
                
                sources.forEach((source, index) => {
                    const originalSrc = source.getAttribute('src');
                    console.log(`ğŸ“¹ Source ${index + 1} (å…ƒã®ãƒ‘ã‚¹): ${originalSrc}`);
                    
                    // ãƒ‘ã‚¹ãŒæ­£ã—ãè§£æ±ºã•ã‚Œã‚‹ã‹ç¢ºèª
                    let resolvedPath = originalSrc;
                    if (originalSrc.startsWith('../')) {
                        // ç›¸å¯¾ãƒ‘ã‚¹ã‚’çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›ã—ã¦ç¢ºèª
                        try {
                            const resolvedUrl = new URL(originalSrc, window.location.href);
                            resolvedPath = resolvedUrl.pathname;
                            console.log(`ğŸ“¹ Source ${index + 1} (è§£æ±ºå¾Œ): ${resolvedPath}`);
                        } catch (e) {
                            console.warn(`âš ï¸ Source ${index + 1}ã®ãƒ‘ã‚¹è§£æ±ºã«å¤±æ•—:`, e);
                        }
                    }
                });
                
                // å‹•ç”»ãŒç¢ºå®Ÿã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¼·åˆ¶è¨­å®šï¼ˆCSS ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãŸã‚æœ€å°é™ã«ï¼‰
                video.style.opacity = '1';
                video.style.visibility = 'visible';
                
                console.log('ğŸ“¹ å‹•ç”»ã®åˆæœŸçŠ¶æ…‹:', {
                    readyState: video.readyState,
                    networkState: video.networkState,
                    error: video.error,
                    src: video.src,
                    currentSrc: video.currentSrc,
                    sourcesCount: sources.length,
                    computedStyle: {
                        display: window.getComputedStyle(video).display,
                        visibility: window.getComputedStyle(video).visibility,
                        opacity: window.getComputedStyle(video).opacity,
                        width: window.getComputedStyle(video).width,
                        height: window.getComputedStyle(video).height
                    }
                });
                
                // å‹•ç”»ã®èª­ã¿è¾¼ã¿æˆåŠŸã‚’ç¢ºèª
                video.addEventListener('loadedmetadata', function() {
                    console.log('âœ… å‹•ç”»ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†');
                    console.log('ğŸ“Š å‹•ç”»æƒ…å ±:', {
                        duration: video.duration,
                        videoWidth: video.videoWidth,
                        videoHeight: video.videoHeight,
                        currentSrc: video.currentSrc
                    });
                });
                
                video.addEventListener('loadeddata', function() {
                    console.log('âœ… å‹•ç”»ã®ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:', video.currentSrc || video.src);
                    video.style.opacity = '1';
                    video.style.visibility = 'visible';
                });
                
                video.addEventListener('canplay', function() {
                    console.log('âœ… å‹•ç”»ã®å†ç”Ÿæº–å‚™å®Œäº†:', video.currentSrc || video.src);
                    // è‡ªå‹•å†ç”Ÿã‚’è©¦è¡Œ
                    video.play().then(() => {
                        console.log('â–¶ï¸ å‹•ç”»ã®è‡ªå‹•å†ç”Ÿã‚’é–‹å§‹ã—ã¾ã—ãŸ');
                    }).catch(err => {
                        console.warn('âš ï¸ è‡ªå‹•å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œãŒå¿…è¦ãªå¯èƒ½æ€§ï¼‰:', err);
                    });
                });
                
                video.addEventListener('canplaythrough', function() {
                    console.log('âœ… å‹•ç”»ã®å®Œå…¨èª­ã¿è¾¼ã¿å®Œäº†ï¼ˆãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°å®Œäº†ï¼‰');
                });
                
                // å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
                let errorHandled = false;
                video.addEventListener('error', function(e) {
                    if (errorHandled) return; // ä¸€åº¦ã ã‘å‡¦ç†
                    
                    console.error('âŒ å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
                    console.error('ğŸ“¹ å‹•ç”»ã®çŠ¶æ…‹:', {
                        error: video.error,
                        errorCode: video.error ? video.error.code : null,
                        errorMessage: video.error ? video.error.message : null,
                        networkState: video.networkState,
                        currentSrc: video.currentSrc,
                        src: video.src
                    });
                    
                    // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã®èª¬æ˜
                    if (video.error) {
                        const errorMessages = {
                            1: 'MEDIA_ERR_ABORTED - å‹•ç”»ã®èª­ã¿è¾¼ã¿ãŒä¸­æ–­ã•ã‚Œã¾ã—ãŸ',
                            2: 'MEDIA_ERR_NETWORK - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆ404ãªã©ï¼‰',
                            3: 'MEDIA_ERR_DECODE - å‹•ç”»ã®ãƒ‡ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼',
                            4: 'MEDIA_ERR_SRC_NOT_SUPPORTED - å‹•ç”»å½¢å¼ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“'
                        };
                        console.error('ã‚¨ãƒ©ãƒ¼è©³ç´°:', errorMessages[video.error.code] || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼');
                        
                        // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆ404ãªã©ï¼‰ã®å ´åˆã€çµ¶å¯¾ãƒ‘ã‚¹ã‚’è©¦ã™
                        if (video.error.code === 2) {
                            const firstSource = video.querySelector('source');
                            if (firstSource) {
                                const currentSrc = firstSource.getAttribute('src');
                                const fallbackSrc = firstSource.getAttribute('data-fallback-src');
                                
                                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹ã‚’è©¦ã™
                                if (fallbackSrc && !firstSource.getAttribute('data-retry')) {
                                    console.log('ğŸ”„ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã€‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹ã«åˆ‡ã‚Šæ›¿ãˆã¾ã™...');
                                    console.log('ğŸ“‚ ç¾åœ¨ã®ãƒ‘ã‚¹:', currentSrc);
                                    console.log('ğŸ“‚ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹:', fallbackSrc);
                                    firstSource.setAttribute('src', fallbackSrc);
                                    firstSource.setAttribute('data-retry', 'true');
                                    errorHandled = false; // ãƒªãƒˆãƒ©ã‚¤ã®ãŸã‚ã€ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
                                    video.load(); // å†èª­ã¿è¾¼ã¿
                                    return;
                                } else if (currentSrc && !fallbackSrc) {
                                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€è¨­å®šã—ã¦å†è©¦è¡Œ
                                    const alternativePath = currentSrc.startsWith('/') 
                                        ? '../assets/videos/event-hiro.webm' 
                                        : '/assets/videos/event-hiro.webm';
                                    console.log('ğŸ”„ ä»£æ›¿ãƒ‘ã‚¹ã‚’è¨­å®šã—ã¦å†è©¦è¡Œã—ã¾ã™:', alternativePath);
                                    firstSource.setAttribute('src', alternativePath);
                                    firstSource.setAttribute('data-retry', 'true');
                                    errorHandled = false;
                                    video.load();
                                    return;
                                }
                            }
                        }
                    }
                    
                    errorHandled = true;
                    
                    // ã™ã¹ã¦ã®è©¦è¡ŒãŒå¤±æ•—ã—ãŸå ´åˆã€ãƒã‚¹ã‚¿ãƒ¼ç”»åƒã‚’è¡¨ç¤º
                    const wrapper = video.parentElement;
                    if (wrapper && video.poster) {
                        console.log('ğŸ–¼ï¸ ã™ã¹ã¦ã®è©¦è¡ŒãŒå¤±æ•—ã—ã¾ã—ãŸã€‚ãƒã‚¹ã‚¿ãƒ¼ç”»åƒã‚’è¡¨ç¤ºã—ã¾ã™');
                        video.style.display = 'none';
                        const img = document.createElement('img');
                        img.src = video.poster;
                        img.alt = 'ã´ã«ã‚‡ãã‚‰ã‚€ã‚¤ãƒ™ãƒ³ãƒˆç´¹ä»‹';
                        img.style.cssText = 'width: 100%; height: auto; display: block; aspect-ratio: 16 / 9; object-fit: cover;';
                        wrapper.appendChild(img);
                    }
                });
                
                // å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚’å¼·åˆ¶
                try {
                    console.log('ğŸ”„ å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹ã—ã¾ã™...');
                    
                    // ã¾ãšã€sourceè¦ç´ ã®å­˜åœ¨ã‚’ç¢ºèªã—ã€ãƒ‘ã‚¹ã‚’æ¤œè¨¼
                    const firstSource = video.querySelector('source');
                    if (firstSource) {
                        let videoPath = firstSource.getAttribute('src');
                        console.log('ğŸ“‚ å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆå…ƒï¼‰:', videoPath);
                        console.log('ğŸ“‚ ç¾åœ¨ã®ãƒšãƒ¼ã‚¸URL:', window.location.href);
                        
                        // ãƒ‘ã‚¹ã‚’è§£æ±º
                        let resolvedUrl;
                        try {
                            resolvedUrl = new URL(videoPath, window.location.href);
                            console.log('ğŸ“‚ è§£æ±ºã•ã‚ŒãŸå‹•ç”»URL:', resolvedUrl.href);
                            
                            // ãƒ‘ã‚¹ãŒçµ¶å¯¾ãƒ‘ã‚¹ã®å ´åˆã€ç›¸å¯¾ãƒ‘ã‚¹ã‚‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦ä¿æŒ
                            if (videoPath.startsWith('/')) {
                                // çµ¶å¯¾ãƒ‘ã‚¹ãŒæ©Ÿèƒ½ã—ãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰
                                const relativePath = '../assets/videos/event-hiro.webm';
                                console.log('ğŸ“‚ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹ï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰:', relativePath);
                                firstSource.setAttribute('data-fallback-src', relativePath);
                            } else if (videoPath.startsWith('../')) {
                                // ç›¸å¯¾ãƒ‘ã‚¹ãŒæ©Ÿèƒ½ã—ãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆçµ¶å¯¾ãƒ‘ã‚¹ï¼‰
                                const absolutePath = '/assets/videos/event-hiro.webm';
                                console.log('ğŸ“‚ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹ï¼ˆçµ¶å¯¾ãƒ‘ã‚¹ï¼‰:', absolutePath);
                                firstSource.setAttribute('data-fallback-src', absolutePath);
                            }
                        } catch (e) {
                            console.error('âŒ URLè§£æ±ºã‚¨ãƒ©ãƒ¼:', e);
                        }
                    } else {
                        console.error('âŒ sourceè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    }
                    
                    // å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚’å¼·åˆ¶å®Ÿè¡Œ
                    video.load();
                    
                    // èª­ã¿è¾¼ã¿çŠ¶æ…‹ã‚’å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯
                    let checkCount = 0;
                    const maxChecks = 20; // 10ç§’é–“ï¼ˆ500ms Ã— 20ï¼‰
                    const checkInterval = setInterval(() => {
                        checkCount++;
                        const currentState = {
                            readyState: video.readyState,
                            networkState: video.networkState,
                            error: video.error,
                            currentSrc: video.currentSrc
                        };
                        
                        if (video.readyState >= 2) { // HAVE_CURRENT_DATAä»¥ä¸Š
                            console.log('âœ… å‹•ç”»ã®èª­ã¿è¾¼ã¿ãŒé€²è¡Œä¸­:', currentState);
                            clearInterval(checkInterval);
                        } else if (video.error) {
                            console.error('âŒ å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ:', currentState);
                            clearInterval(checkInterval);
                        } else if (checkCount >= maxChecks) {
                            console.warn('âš ï¸ å‹•ç”»ã®èª­ã¿è¾¼ã¿ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ:', currentState);
                            clearInterval(checkInterval);
                        } else {
                            console.log(`â³ å‹•ç”»ã®èª­ã¿è¾¼ã¿å¾…æ©Ÿä¸­... (${checkCount}/${maxChecks}):`, currentState);
                        }
                    }, 500);
                    
                } catch (error) {
                    console.error('âŒ å‹•ç”»ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                }
            }
            
            // DOMContentLoadedã¾ãŸã¯æ—¢ã«èª­ã¿è¾¼ã¿æ¸ˆã¿ã®å ´åˆ
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initVideo);
            } else {
                // æ—¢ã«èª­ã¿è¾¼ã¿æ¸ˆã¿ã®å ´åˆã¯å°‘ã—å¾…ã£ã¦ã‹ã‚‰å®Ÿè¡Œï¼ˆDOMãŒå®Œå…¨ã«æ§‹ç¯‰ã•ã‚Œã‚‹ã¾ã§ï¼‰
                setTimeout(initVideo, 100);
            }
        })();
    </script>

<!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠï¼ˆæ—¢å­˜ï¼‰ -->
<div class="main-container">
    <!-- æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
</div>

    
    <div class="main-container">
        <!-- å·¦å´ï¼šã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼ˆ2/3ï¼‰ -->
        <div id="events" class="events-section">
            <h2 class="section-title">ğŸ“¸ ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š - é–‹å‚¬äºˆå®šã‚¤ãƒ™ãƒ³ãƒˆ</h2>
            <div class="events-grid" id="eventsGrid">
                <!-- ã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ã¯å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
            </div>
        </div>
        
        <!-- å³å´ï¼šæœˆé–“ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆ1/3ï¼‰ -->
        <div class="calendar-section">
            <div class="calendar-container">
                <div class="calendar-header">
                    <h3 class="calendar-title" id="calendarTitle">2025å¹´8æœˆ</h3>
                    <div class="calendar-nav">
                        <button onclick="changeMonth(-1)">â€¹</button>
                        <button onclick="changeMonth(1)">â€º</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendar">
                    <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯å‹•çš„ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆ -->
            <div class="event-list" id="eventList">
                <h4 class="event-list-title">ğŸ—“ ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š - ä»Šæœˆã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h4>
                <!-- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã¯å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <script>
        let eventData = [];

        async function loadEvents() {
            try {
                const res = await fetch('data/events.json');
                const json = await res.json();
                const list = json.events || json;
                eventData = (list || []).map(ev => ({
                    id: ev.event_id,
                    name: ev.event_name,
                    date: ev.event_date,
                    venue: ev.venue?.venue_name || '-',
                    price: ev.pricing?.perUnit || ev.pricing?.base_price || 0,
                    type: ev.event_type || 'group',
                    badge: ev.is_limited ? 'æº€å¸­' : 'äºˆç´„å¯',
                    remaining: ev.remaining_slots,
                    pricing: ev.pricing,
                    slug: ev.slug || ev.event_name,
                    thumbnail_image: ev.thumbnail_image
                }));
            } catch (e) {
                console.error('Failed to load events:', e);
            }
        }

        // éå»ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        function filterPastEvents(events) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            return events.filter(event => {
                const eventDate = new Date(event.date);
                eventDate.setHours(0, 0, 0, 0);
                return eventDate >= today;
            });
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
        function generateEventCards() {
            const eventsGrid = document.getElementById('eventsGrid');
            let html = '';
            
            // éå»ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é™¤å¤–
            const futureEvents = filterPastEvents(eventData);
            
            if (futureEvents.length === 0) {
                html = '<div class="no-events-message" style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #666;">é–‹å‚¬äºˆå®šã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“</div>';
            } else {
                futureEvents.forEach(event => {
                const date = new Date(event.date);
                const month = date.getMonth() + 1;
                const day = date.getDate();
                const dayOfWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'][date.getDay()];
                
                let badgeHtml = '';
                if (event.badge === 'new') {
                    badgeHtml = '<span class="event-badge badge-new">NEW</span>';
                } else if (event.badge === 'popular') {
                    badgeHtml = '<span class="event-badge badge-popular">äººæ°—</span>';
                } else if (event.badge === 'limited') {
                    badgeHtml = '<span class="event-badge badge-limited">é™å®š</span>';
                }
                
                const gradient = event.type === 'individual' 
                    ? 'linear-gradient(135deg, #10b981, #3b82f6)'
                    : 'linear-gradient(135deg, #ff6ec7, #3b82f6)';
                
                html += `
                    <div class="event-card" data-id="${event.id}" role="button" tabindex="0" aria-label="${event.name}ã®è©³ç´°ãƒšãƒ¼ã‚¸ã¸ç§»å‹•">
                        <figure class="media-frame is-40x21 fill-gradient" data-focal="center" style="--bg: url('${event.image}')">
                            <img src="${event.image}" alt="${event.name}ã®ç”»åƒ" loading="lazy" decoding="async" ${event.id === 'EVT004' || event.event_id === 'EVT004' ? 'onload="console.log(\'âœ… EVT004 image loaded successfully:\', this.src)" onerror="console.error(\'âŒ EVT004 image failed to load:\', this.src); this.style.display=\'none\'; this.parentElement.className=\'media-frame is-40x21 fill-gradient\'; this.parentElement.innerHTML=\'<div style=\\\'color: white; text-align: center;\\\'>ğŸ“·<br/>ç”»åƒèª­ã¿è¾¼ã¿ä¸­...</div>\'"' : 'onerror="window.__imgFallback(this)"'} data-fallbacks="${event.__cardFallbacks ? event.__cardFallbacks.join(',') : ''}">
                            <div class="media-overlay">
                                ${badgeHtml}
                            </div>
                        </figure>
                        <div class="event-content">
                            <h3 class="event-title">${event.name}</h3>
                            <div class="event-info">ğŸ“… ${month}æœˆ${day}æ—¥(${dayOfWeek})</div>
                            <div class="event-info">ğŸ“ ${event.venue}</div>
                        </div>
                        <div class="event-footer">
                            <span class="event-price">${event.priceText ? event.priceText : `Â¥${(event.price||0).toLocaleString()}${event.type === 'individual' ? '/30åˆ†' : 'ã€œ'}`}</span>
                            <span style="color: #666; font-size: 0.85rem;">
                                ${event.remaining ? `æ®‹ã‚Š${event.remaining}æ ` : 'ç©ºãã‚ã‚Š'}
                            </span>
                        </div>
                        ${event.pricing ? `
                        <div class=\"price-breakdown\" style=\"padding:6px 12px; color:#555; font-size:0.85rem;\">
                            å„éƒ¨ ${'Â¥'+Number(event.pricing.perUnit).toLocaleString()} / 2éƒ¨é€šã— ${'Â¥'+Number(event.pricing.twoParts).toLocaleString()}${event.pricing.threeParts ? ' / 3éƒ¨é€šã— Â¥'+Number(event.pricing.threeParts).toLocaleString() : ''}
                        </div>` : ''}
                        <div class="card-actions">
                            <a href="/event/${event.id}/" class="btn-detail">è©³ç´°ã‚’è¦‹ã‚‹</a>
                        </div>
                    </div>
                `;
                });
            }
            
            eventsGrid.innerHTML = html;
            
            // ã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰å…¨ä½“ã«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
            document.querySelectorAll('.event-card').forEach(card => {
                const handleCardClick = (e) => {
                    if (e.target.classList.contains('btn-detail') || e.target.closest('.btn-detail')) {
                        return;
                    }
                    const eventId = card.dataset.id;
                    window.location.href = `/event/${eventId}/`;
                };
                card.addEventListener('click', handleCardClick);
                card.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        handleCardClick(e);
                    }
                });
                card.style.cursor = 'pointer';
            });
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’ç”Ÿæˆ
        function generateEventList() {
            const eventList = document.getElementById('eventList');
            const monthNames = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
            let html = `<h4 class="event-list-title">ğŸ—“ ${currentYear}å¹´${monthNames[currentMonth - 1]}ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h4>`;
            
            // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨åŒã˜æœˆã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆéå»ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é™¤å¤–ï¼‰
            const currentMonthEvents = filterPastEvents(eventData.filter(event => {
                const eventDate = new Date(event.date);
                return eventDate.getFullYear() === currentYear && eventDate.getMonth() + 1 === currentMonth;
            }));
            
            if (currentMonthEvents.length === 0) {
                html += '<div class="event-list-item no-events">ã“ã®æœˆã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“</div>';
            } else {
                currentMonthEvents.forEach(event => {
                    const date = new Date(event.date);
                    const day = date.getDate();
                    const typeText = event.type === 'individual' ? 'å€‹äººæ’®å½±ä¼š' : 'å›£ä½“æ’®å½±ä¼š';
                    
                    html += `
                        <div class="event-list-item" data-id="${event.id}">
                            <div class="event-list-date">${day}</div>
                            <div class="event-list-info">
                                <div class="event-list-name">${event.name}</div>
                                <div class="event-list-type">${typeText}</div>
                            </div>
                        </div>
                    `;
                });
            }
            
            eventList.innerHTML = html;
            
            // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤ºã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨åŒæœŸ
            const eventListTitle = eventList.querySelector('.event-list-title');
            if (eventListTitle) {
                eventListTitle.textContent = `ğŸ—“ ${currentYear}å¹´${monthNames[currentMonth - 1]}ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«`;
            }
            
            document.querySelectorAll('.event-list-item').forEach(item => {
                if (!item.classList.contains('no-events')) {
                    item.addEventListener('click', () => {
                        const eventId = item.dataset.id;
                        location.href = `/event/${eventId}/`;
                    });
                }
            });
        }
        
        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”Ÿæˆ
        let currentYear = 2025;
        let currentMonth = 8;
        
        // ç¾åœ¨ã®æ—¥ä»˜ã‹ã‚‰æœ€ã‚‚è¿‘ã„ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚‹æœˆã‚’å–å¾—
        function getNearestEventMonth() {
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth() + 1;
            const currentDate = today.getDate();
            
            // æœªæ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            const futureEvents = eventData.filter(event => {
                const eventDate = new Date(event.date);
                const todayDate = new Date(currentYear, currentMonth - 1, currentDate);
                return eventDate >= todayDate;
            });
            
            if (futureEvents.length === 0) {
                // æœªæ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒãªã„å ´åˆã¯ç¾åœ¨ã®æœˆã‚’è¿”ã™
                return { year: currentYear, month: currentMonth };
            }
            
            // æ—¥ä»˜é †ã«ã‚½ãƒ¼ãƒˆ
            futureEvents.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // æœ€ã‚‚è¿‘ã„ã‚¤ãƒ™ãƒ³ãƒˆã®æœˆã‚’å–å¾—
            const nearestEvent = futureEvents[0];
            const nearestEventDate = new Date(nearestEvent.date);
            const nearestYear = nearestEventDate.getFullYear();
            const nearestMonth = nearestEventDate.getMonth() + 1;
            
            return { year: nearestYear, month: nearestMonth };
        }
        
        function generateCalendar(year, month) {
            const calendar = document.getElementById('calendar');
            const firstDay = new Date(year, month - 1, 1);
            const lastDay = new Date(year, month, 0);
            const prevLastDay = new Date(year, month - 1, 0);
            
            const startingDayOfWeek = firstDay.getDay();
            const monthLength = lastDay.getDate();
            const prevMonthLength = prevLastDay.getDate();
            
            let html = '';
            
            const weekdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            weekdays.forEach(day => {
                html += `<div class="calendar-weekday">${day}</div>`;
            });
            
            for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                html += `<div class="calendar-day other-month">
                    <div class="calendar-day-number">${prevMonthLength - i}</div>
                </div>`;
            }
            
            const today = new Date();
            for (let day = 1; day <= monthLength; day++) {
                const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                // éå»ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é™¤å¤–
                const dayEvents = filterPastEvents(eventData.filter(e => e.date === dateStr));
                const isToday = today.getFullYear() === year && today.getMonth() + 1 === month && today.getDate() === day;
                
                let dayClass = 'calendar-day';
                if (isToday) dayClass += ' today';
                if (dayEvents.length > 0) dayClass += ' has-event';
                
                html += `<div class="${dayClass}">
                    <div class="calendar-day-number">${day}</div>`;
                
                const maxEvents = 3;
                const displayEvents = dayEvents.slice(0, maxEvents);
                
                displayEvents.forEach(event => {
                    const shortName = event.name.length > 6 ? event.name.substring(0, 6) + '...' : event.name;
                    html += `<div class="calendar-event ${event.type}">${shortName}</div>`;
                });
                
                if (dayEvents.length > maxEvents) {
                    const remainingCount = dayEvents.length - maxEvents;
                    html += `<div class="calendar-event more-events">+${remainingCount}</div>`;
                }
                
                html += '</div>';
            }
            
            const totalCells = startingDayOfWeek + monthLength;
            const nextMonthDays = 42 - totalCells;
            for (let day = 1; day <= nextMonthDays; day++) {
                html += `<div class="calendar-day other-month">
                    <div class="calendar-day-number">${day}</div>
                </div>`;
            }
            
            calendar.innerHTML = html;
            
            const monthNames = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
            const calendarTitle = document.getElementById('calendarTitle');
            if (calendarTitle) {
                calendarTitle.textContent = `${year}å¹´${monthNames[month - 1]}`;
            }
        }
        
        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth > 12) {
                currentMonth = 1;
                currentYear++;
            } else if (currentMonth < 1) {
                currentMonth = 12;
                currentYear--;
            }
            generateCalendar(currentYear, currentMonth);
            generateEventList(); // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚‚æ›´æ–°ï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨åŒã˜æœˆã‚’è¡¨ç¤ºï¼‰
        }
        
        // æœ€æ–°ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ï¼ˆæ—¥ä»˜é †ã§ã‚½ãƒ¼ãƒˆï¼‰
        function getLatestEvent() {
            if (eventData.length === 0) return null;
            
            // æœªæ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const futureEvents = eventData.filter(event => {
                const eventDate = new Date(event.date);
                eventDate.setHours(0, 0, 0, 0);
                return eventDate >= today;
            });
            
            if (futureEvents.length === 0) {
                // æœªæ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒãªã„å ´åˆã¯æœ€æ–°ã®éå»ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿”ã™
                return eventData.sort((a, b) => new Date(b.date) - new Date(a.date))[0];
            }
            
            // æœªæ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ—¥ä»˜é †ã§ã‚½ãƒ¼ãƒˆã—ã¦æœ€æ–°ã®ã‚‚ã®ã‚’è¿”ã™
            return futureEvents.sort((a, b) => new Date(a.date) - new Date(b.date))[0];
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆç”»åƒURLã‚’ç”Ÿæˆ
        function getEventHeroImageUrl(event) {
            if (!event) return null;
            
            // thumbnail_imageãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã‚Œã‚’å„ªå…ˆä½¿ç”¨
            if (event.thumbnail_image && event.thumbnail_image.startsWith('http')) {
                return event.thumbnail_image;
            }
            
            // slugã‹ã‚‰ç”»åƒURLã‚’ç”Ÿæˆ
            let slug = event.slug || event.name;
            if (slug && slug.includes('/')) {
                slug = slug.replace(/\//g, ':');
            }
            
            // pinyogramlp/events/ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’å‰Šé™¤
            if (slug.startsWith('pinyogramlp:events:')) {
                slug = slug.replace('pinyogramlp:events:', '');
            } else if (slug.startsWith('pinyogramlp/events/')) {
                slug = slug.replace('pinyogramlp/events/', '').replace(/\//g, ':');
            }
            
            // URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
            const encodedSlug = encodeURIComponent(slug);
            return `https://images.pinyogram.com/events/${encodedSlug}/main/hero.png`;
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            await loadEvents();

            // ç”»åƒè¨­å®šèª­è¾¼ï¼ˆCloudflareæ§‹æˆå¯¾å¿œï¼‰
            const fallbackHero = 'https://placehold.co/1920x1080/png?text=Pinyogram';
            const fallbackCard = 'https://placehold.co/800x600/png?text=Event';
            
            // æœ€æ–°ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—
            const latestEvent = getLatestEvent();
            let heroImageUrl = fallbackHero;
            let heroEventId = 'EVT005';
            let heroEventName = 'ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š';
            
            if (latestEvent) {
                heroEventId = latestEvent.id;
                heroEventName = latestEvent.name;
                const eventImageUrl = getEventHeroImageUrl(latestEvent);
                if (eventImageUrl) {
                    heroImageUrl = eventImageUrl;
                }
            } else {
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: EVT005ã®ç”»åƒã‚’ä½¿ç”¨
                heroImageUrl = 'https://images.pinyogram.com/events/2025%3A10%3A21%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E6%92%AE%E5%BD%B1%E4%BC%9Awith%E7%A6%8F%E5%B3%B6%E8%A3%95%E4%BA%8C/main/Frame%2056.png';
            }
            
            console.log('ğŸ–¼ï¸ Setting hero image:', {
                heroImageUrl: heroImageUrl,
                heroEventId: heroEventId,
                heroEventName: heroEventName
            });
            
            // ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã‚’è¨­å®šï¼ˆ3ã¤ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã™ã¹ã¦ã«åŒã˜ç”»åƒã‚’é©ç”¨ï¼‰
            // å‹•ç”»ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ç”»åƒå‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—
            const heroVideo = document.getElementById('hero-video');
            if (!heroVideo) {
                ['heroImg1','heroImg2','heroImg3'].forEach(id => { 
                    const el = document.getElementById(id); 
                    if (el) {
                        el.src = heroImageUrl;
                        el.alt = `${heroEventId} ${heroEventName} - ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ã‚’è¡¨ç¤º`;
                        
                        // ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
                        el.onerror = function() {
                            console.warn('âš ï¸ Hero image failed to load, using fallback:', heroImageUrl);
                            this.src = fallbackHero;
                            this.alt = 'ã´ã«ã‚‡ãã‚‰ã‚€æ’®å½±ä¼š - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”»åƒ';
                        };
                        
                        // ç”»åƒèª­ã¿è¾¼ã¿æˆåŠŸæ™‚ã®ãƒ­ã‚°
                        el.onload = function() {
                            console.log('âœ… Hero image loaded successfully:', heroImageUrl);
                        };
                    }
                });
            } else {
                console.log('ğŸ“¹ ãƒ’ãƒ¼ãƒ­ãƒ¼å‹•ç”»ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ç”»åƒå‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸ');
            }

            // ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ï¼ˆå‹•ç”»ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—ï¼‰
            if (!heroVideo) {
                const heroLink = document.querySelector('.hero-frame .media-overlay .hero-link');
                if (heroLink) {
                    heroLink.href = `/event/${heroEventId}/`;
                    heroLink.setAttribute('aria-label', `${heroEventId} ${heroEventName} ã®è©³ç´°ãƒšãƒ¼ã‚¸ã¸ç§»å‹•`);
                    console.log('ğŸ”— Hero link found, adding click event');
                    heroLink.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log(`ğŸ¯ Hero image clicked, navigating to ${heroEventId}`);
                        window.location.href = `/event/${heroEventId}/`;
                    });
                    
                    // ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒå…¨ä½“ã«ã‚‚ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ï¼ˆä¿é™ºï¼‰
                    const heroFrame = document.querySelector('.hero-frame');
                    if (heroFrame) {
                        heroFrame.addEventListener('click', function(e) {
                            if (e.target.tagName !== 'A') {
                                console.log(`ğŸ¯ Hero frame clicked, navigating to ${heroEventId}`);
                                window.location.href = `/event/${heroEventId}/`;
                            }
                        });
                        heroFrame.style.cursor = 'pointer';
                    }
                } else {
                    console.warn('âš ï¸ Hero link not found');
                }
            }

            // ãƒ’ãƒ¼ãƒ­ãƒ¼ãƒãƒ³ãƒ‰ã®èƒŒæ™¯URLè¨­å®šæ©Ÿèƒ½
            function applyBg(band) {
                const img = band.querySelector('img');
                if (!img) return;
                const url = 'url("' + (img.currentSrc || img.src) + '")';
                band.style.setProperty('--bg', url);
                console.log('ğŸ¨ Applied background URL to hero-band:', url);
            }

            // ã™ã¹ã¦ã®ãƒ’ãƒ¼ãƒ­ãƒ¼ãƒãƒ³ãƒ‰ã«èƒŒæ™¯URLã‚’é©ç”¨
            document.querySelectorAll('.hero-band').forEach(band => {
                const img = band.querySelector('img');
                if (!img) return;

                // åˆæœŸåæ˜ 
                if (img.complete) {
                    applyBg(band);
                } else {
                    img.addEventListener('load', () => applyBg(band), { once: true });
                }

                // ç”»åƒå·®ã—æ›¿ãˆï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ç­‰ï¼‰ã«ã‚‚è¿½éš
                new MutationObserver(() => applyBg(band))
                    .observe(img, { attributes: true, attributeFilter: ['src', 'srcset'] });
            });
            // å„ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚«ãƒ¼ãƒ‰ç”»åƒã«æ‹¡å¼µå­ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆjpg/png/webpï¼‰
            const cacheBuster = '?v=' + Date.now();
            eventData.forEach(e => {
                let slug = e.slug || e.name;
                // ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°ãƒšãƒ¼ã‚¸ã¨åŒã˜ã‚¹ãƒ©ãƒƒã‚°å‡¦ç†ã‚’é©ç”¨
                if (slug && slug.includes('/')) {
                    slug = slug.replace(/\//g, ':');
                }
                
                // pinyogramlp/events/ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’å‰Šé™¤
                if (slug && slug.startsWith('pinyogramlp:events:')) {
                    slug = slug.replace('pinyogramlp:events:', '');
                } else if (slug && slug.startsWith('pinyogramlp/events/')) {
                    slug = slug.replace('pinyogramlp/events/', '').replace(/\//g, ':');
                }
                
                console.log('ğŸ´ Processing card image for event:', {
                    eventName: e.event_name || e.name,
                    originalSlug: e.slug,
                    processedSlug: slug,
                    thumbnail_image: e.thumbnail_image
                });
                
                // thumbnail_imageãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã‚Œã‚’å„ªå…ˆä½¿ç”¨
                if (e.thumbnail_image && e.thumbnail_image.startsWith('http')) {
                    e.image = e.thumbnail_image + cacheBuster;
                    e.__cardFallbacks = []; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ï¼ˆç›´æ¥URLä½¿ç”¨ï¼‰
                    console.log('ğŸ´ Using thumbnail_image URL:', e.thumbnail_image);
                }
                // EVT004ã®å ´åˆã¯æä¾›ã•ã‚ŒãŸURLã‚’ç›´æ¥ä½¿ç”¨ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
                else if (e.id === 'EVT004' || e.event_id === 'EVT004') {
                    const directUrl = 'https://images.pinyogram.com/events/%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E6%92%AE%E5%BD%B1%E4%BC%9A2025:09:16/main/hero.png';
                    e.image = directUrl + cacheBuster;
                    e.__cardFallbacks = []; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ï¼ˆç›´æ¥URLä½¿ç”¨ï¼‰
                    console.log('ğŸ´ Using direct URL for EVT004:', directUrl);
                }
                // EVT006ã®å ´åˆã¯slugã‹ã‚‰ç”»åƒURLã‚’ç”Ÿæˆ
                else if (e.id === 'EVT006' || e.event_id === 'EVT006') {
                    const encodedSlug = encodeURIComponent(slug);
                    const directUrl = `https://images.pinyogram.com/events/${encodedSlug}/main/hero.png`;
                    e.image = directUrl + cacheBuster;
                    e.__cardFallbacks = []; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ï¼ˆç›´æ¥URLä½¿ç”¨ï¼‰
                    console.log('ğŸ´ Using direct URL for EVT006:', directUrl);
                } else if (window.getEventAssetUrlCandidates) {
                    // ãã®ä»–ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯å¾“æ¥ã®å‡¦ç†
                    const cands = window.getEventAssetUrlCandidates(slug, 'main', 'hero', ['png','jpg','webp']);
                    console.log('ğŸ´ Generated card image URLs:', {
                        eventName: e.event_name || e.name,
                        slug,
                        candidates: cands,
                        selectedUrl: cands[0]
                    });
                    e.image = (cands[0] || fallbackCard) + cacheBuster;
                    e.__cardFallbacks = cands.slice(1).map(url => url + cacheBuster);
                } else {
                    const url = window.getEventAssetUrl ? window.getEventAssetUrl(slug, 'main', 'hero.png') : (window.APP_IMAGE && window.APP_IMAGE.event);
                    console.log('ğŸ´ Generated single card image URL:', {
                        eventName: e.event_name || e.name,
                        slug,
                        url
                    });
                    e.image = (url || fallbackCard) + cacheBuster;
                }
            });

            generateEventCards();
            
            // æœ€ã‚‚è¿‘ã„ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚‹æœˆã‚’å–å¾—ã—ã¦ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’åˆæœŸåŒ–
            const nearestEventMonth = getNearestEventMonth();
            currentYear = nearestEventMonth.year;
            currentMonth = nearestEventMonth.month;
            
            console.log('ğŸ“… Initializing calendar with nearest event month:', {
                year: currentYear,
                month: currentMonth,
                events: eventData.length
            });
            
            generateCalendar(currentYear, currentMonth);
            generateEventList(); // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åˆæœŸåŒ–å¾Œã«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤ºã‚‚åŒæœŸ
        });
    </script>

    <!-- å…±æœ‰ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <div id="site-footer"></div>

    <!-- JavaScript (ES6 Modules) -->
    <script src="../shared/js/config.js"></script>
    <script type="module" src="js/shared/main.js"></script>
    <script defer src="../shared/header.js"></script>
    <script defer src="../shared/footer.js"></script>
    
    <!-- è‡ªå‹•2è‰²æŠ½å‡ºJS -->
    <script>
    (() => {
      const frames = document.querySelectorAll('.media-frame.fill-gradient');
      frames.forEach(frame => {
        const img = frame.querySelector('img');
        if (!img) return;
        const apply = () => {
          try{
            const c = document.createElement('canvas'), ctx = c.getContext('2d');
            const w = c.width = 24, h = c.height = 24;
            ctx.drawImage(img, 0, 0, w, h);
            const {data} = ctx.getImageData(0,0,w,h);
            let lR=0,lG=0,lB=0,lN=0, rR=0,rG=0,rB=0,rN=0;
            for(let y=0;y<h;y++)for(let x=0;x<w;x++){
              const i=(y*w+x)*4, R=data[i], G=data[i+1], B=data[i+2];
              if(x<w/2){ lR+=R; lG+=G; lB+=B; lN++; } else { rR+=R; rG+=G; rB+=B; rN++; }
            }
            frame.style.setProperty('--c1',`rgb(${(lR/lN)|0},${(lG/lN)|0},${(lB/lN)|0})`);
            frame.style.setProperty('--c2',`rgb(${(rR/rN)|0},${(rG/rN)|0},${(rB/rN)|0})`);
          }catch(e){}
        };
        img.complete ? apply() : img.addEventListener('load', apply, {once:true});
      });
    })();
    </script>
</body>
</html>